dat <- read.table("http://www.ats.ucla.edu/stat/stata/dae/nb_data.dta")
zinb <- read.csv("http://www.ats.ucla.edu/stat/data/fish.csv")
zinb
names(zinb)
hist
hist(count)
names(zinb)
hist(zinb$count)
hist(zinb$count)
annual = read.table("http://myweb.fsu.edu/jelsner/data/AnnualData.txt", header = TRUE)
annual
names(annual)
dat = subset(annual, Year >= 1950)
df = data.frame(H = dat$B.1, SOI = dat$soi, SST = dat$sst)
df
plot(dat)
df
plot(df$SOI,df$H)
plot(df$SST,df$H)
prm = glm(H ~ SOI + SST, data = df, family = "poisson")
prm
summary(prm)
setwd('Dropbox/Teaching/BayesLearning/Code/')
data <- read.table('eBayNumberOfBidderData.dat')
head(data)
?glm
glm(nBids ~ LogBook + MinBidShare, data = data)
data
glm(nBids ~ LogBook + MinBidShare, data = data)
names(data)
data
data <- read.table('eBayNumberOfBidderData.dat')
names(data)
data <- read.table('eBayNumberOfBidderData.dat',header=True)
data <- read.table('eBayNumberOfBidderData.dat',header=TRUE)
names(data)
glm(nBids ~ LogBook + MinBidShare, data = data)
glm(nBids ~ LogBook + MinBidShare + Const, data = data)
glm(nBids ~ LogBook + MinBidShare + Const, data = data, constant = )
data$MinBidShare
library(geoR)
install.packages("geoR") # We need the rinvchisq() function for simulating random draws from the scaled inv chi-square.
library(geoR)
rinvchisq
install.packages("LaplacesDemon")
install.packages("asbio")
library("asbio")
?rchi
?rchi2
?rchisq
summary(rchisq(1000,4))
sd(rchisq(1000,4))
var(rchisq(1000,4))
2*4
var(rchisq(10000,4))
var(rchisq(10000,4))
var(rchisq(10000,4))
rScaledInvChi2 <- function(n, nu, s2){
return (nu*s2)/rchisq(n,df=nu)
}
rScaledInvChi2(10,4,2)
rScaledInvChi2(10,4,2)
rScaledInvChi2(10,4,2)
rScaledInvChi2(10,4,2)
rScaledInvChi2 <- function(n, nu, s2){
return((nu*s2)/rchisq(n,df=nu))
}
rScaledInvChi2(10,4,2)
rScaledInvChi2(10,4,2)
rScaledInvChi2(10,4,2)
rScaledInvChi2(10,4,2)
c(mean(rScaledInvChi2(10,4,2)),sd(rScaledInvChi2(10,4,2)))
c(mean(rScaledInvChi2(10,4,2)),sd(rScaledInvChi2(10,4,2)))
c(mean(rScaledInvChi2(10,4,2)),sd(rScaledInvChi2(10,4,2)))
c(mean(rScaledInvChi2(10,4,2)),sd(rScaledInvChi2(10,4,2)))
c(mean(rScaledInvChi2(10,4,2)),sd(rScaledInvChi2(10,4,2)))
c(mean(rScaledInvChi2(10,4,2)),sd(rScaledInvChi2(10,4,2)))
c(mean(rScaledInvChi2(10,4,2)),sd(rScaledInvChi2(10,4,2)))
c(mean(rScaledInvChi2(10,4,2)),sd(rScaledInvChi2(10,4,2)))
c(mean(rScaledInvChi2(10,4,2)),sd(rScaledInvChi2(10,4,2)))
c(mean(rScaledInvChi2(10,4,2)),sd(rScaledInvChi2(10,4,2)))
c(mean(rScaledInvChi2(10,4,2)),sd(rScaledInvChi2(10,4,2)))
c(mean(rScaledInvChi2(10,4,2)),sd(rScaledInvChi2(10,4,2)))
c(mean(rScaledInvChi2(10,4,2)),var(rScaledInvChi2(10,4,2)))
c(mean(rScaledInvChi2(10,4,2)),var(rScaledInvChi2(10,4,2)))
c(mean(rScaledInvChi2(10000,4,2)),var(rScaledInvChi2(10000,4,2)))
c(mean(rScaledInvChi2(10000,4,2)),var(rScaledInvChi2(10000,4,2)))
c(mean(rScaledInvChi2(10000,4,2)),var(rScaledInvChi2(10000,4,2)))
c(mean(rScaledInvChi2(10000,4,2)),var(rScaledInvChi2(10000,4,2)))
c(mean(rScaledInvChi2(10000,4,2)),var(rScaledInvChi2(10000,4,2)))
c(mean(rScaledInvChi2(100000,4,2)),var(rScaledInvChi2(100000,4,2)))
c(mean(rScaledInvChi2(100000,4,2)),var(rScaledInvChi2(100000,4,2)))
c(mean(rScaledInvChi2(100000,4,2)),var(rScaledInvChi2(100000,4,2)))
c(mean(rScaledInvChi2(100000,4,2)),var(rScaledInvChi2(100000,4,2)))
c(mean(rScaledInvChi2(100000,4,2)),var(rScaledInvChi2(100000,4,2)))
c(mean(rScaledInvChi2(100000,4,2)),var(rScaledInvChi2(100000,4,2)))
c(mean(rScaledInvChi2(100000,4,2)),var(rScaledInvChi2(100000,4,2)))
c(mean(rScaledInvChi2(100000,6,2)),var(rScaledInvChi2(100000,6,2)))
c(mean(rScaledInvChi2(100000,6,2)),var(rScaledInvChi2(100000,6,2)))
c(mean(rScaledInvChi2(100000,6,2)),var(rScaledInvChi2(100000,6,2)))
c(mean(rScaledInvChi2(100000,6,2)),var(rScaledInvChi2(100000,6,2)))
c(nu*s2/(nu-2))
nu<-4,s2<-3,c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)))
nu<-4;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)))
nu<-4;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)))
nu<-4;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2))),c(nu*s2/(nu-2))
nu<-4;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2))
nu<-4;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2))
nu<-4;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2))
nu<-4;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2),2*nu^2*s2^2/((nu-2)^2*(nu-4)))
nu<-4;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2),2*nu^2*s2^2/((nu-2)^2*(nu-4)))
nu<-6;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2),2*nu^2*s2^2/((nu-2)^2*(nu-4)))
nu<-6;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2),2*nu^2*s2^2/((nu-2)^2*(nu-4)))
nu<-6;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2),2*nu^2*s2^2/((nu-2)^2*(nu-4)))
nu<-6;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2),2*nu^2*s2^2/((nu-2)^2*(nu-4)))
nu<-6;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2),2*nu^2*s2^2/((nu-2)^2*(nu-4)))
nu<-6;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2),2*nu^2*s2^2/((nu-2)^2*(nu-4)))
nu<-6;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2),2*nu^2*s2^2/((nu-2)^2*(nu-4)))
nu<-6;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2),2*nu^2*s2^2/((nu-2)^2*(nu-4)))
nu<-6;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2),2*nu^2*s2^2/((nu-2)^2*(nu-4)))
nu<-6;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2),2*nu^2*s2^2/((nu-2)^2*(nu-4)))
nu<-6;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2),2*nu^2*s2^2/((nu-2)^2*(nu-4)))
nu<-6;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2),2*nu^2*s2^2/((nu-2)^2*(nu-4)))
nu<-6;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2),2*nu^2*s2^2/((nu-2)^2*(nu-4)))
nu<-6;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2),2*nu^2*s2^2/((nu-2)^2*(nu-4)))
nu<-6;s2<-3;c(mean(rScaledInvChi2(100000,nu,s2)),var(rScaledInvChi2(100000,nu,s2)));c(nu*s2/(nu-2),2*nu^2*s2^2/((nu-2)^2*(nu-4)))
source('~/Dropbox/Teaching/BayesLearning/Code/NormalMixtureGibbs.R')
source('~/Dropbox/Teaching/BayesLearning/Code/NormalMixtureGibbs.R')
?dnorm
dnorm(c(3,4),0,4)
dnorm(c(0,0),0,4)
dnorm(c(0,0),0,1)
dnorm(matrix(c(0,0,1,1),2,2),0,1)
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
likelihood
loglikelihood
logLikelihood
plot(logLikelihood)
plot(logLikelihood,type="l")
plot(logLikelihood[1:100],type="l")
plot(logLikelihood,type="l")
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
pi
gammalnÂ¨
gammaln
gamma(3,log=TRUE)
?gamma
lgamma(4)
log(gamma(4))
?sd
MargLike <- function(xVect,mu0,kappa0,nu0,sigma20){
n <- length(x)
xBar <- mean(x)
s2 = sd(x)
kappan <- kappa0 + n
nun <- nu0 + n
nunsigma2n <- nu0*sigma20 + (n-1)*s2 + (kappa0*n/(kappa0 + n))*(xBar-mu0)^2
mun <- (kappa0/kappan)*mu0 + (n/kappan)*xBar
logMargLike <- -(n/2)*log(2*pi) -(1/2)*sum(x) -log(kappan/kappa0) +(kappan*mun^2-kappa0*mu0^2) +nu0*log(nu0*sigma20) +nun*log(nunsigma2n)
+2*lgamma(nun/2) -2*lgamma(nu0/2) + (nunsigma2n - nu0*sigma20)
}
xVect <- rnorm(100,mean = 1, sd = 2);MargLike(xVect,mu0,kappa0,nu0,sigma20)
xVect <- rnorm(100,mean = 1, sd = 2);kappa0 = 10;mu0= 1;nu0= 10;sigma20 <- 1; lml <- MargLike(xVect,mu0,kappa0,nu0,sigma20)
lml''
lml
xVect <- rnorm(1000,mean = 1, sd = 2);kappa0 = 10;mu0= 1;nu0= 10;sigma20 <- 1; lml <- MargLike(xVect,mu0,kappa0,nu0,sigma20)
xVect <- rnorm(1000,mean = 1, sd = 2);kappa0 = 10;mu0= 1;nu0= 10;sigma20 <- 1; for (i in 1:100) lml <- MargLike(xVect,mu0,kappa0,nu0,sigma20)
xVect <- rnorm(1000,mean = 1, sd = 2);kappa0 = 10;mu0= 1;nu0= 10;sigma20 <- 1; for (i in 1:1000) lml <- MargLike(xVect,mu0,kappa0,nu0,sigma20)
?rmultinom
rmultinom(n = 10,prob = c(0.3.0.4,0.4))
rmultinom(n = 10,prob = c(0.3.0.4,0.3))
rmultinom(n = 10,size = 4, prob = c(0.3.0.4,0.3))
rmultinom(n = 10,size = 4, prob = c(0.3,0.4,0.3))
rmultinom(n = 10, prob = c(0.3,0.4,0.3))
rmultinom(n = 10, size = 3, prob = c(0.3,0.4,0.3))
rmultinom(n = 10, size = 1, prob = c(0.3,0.4,0.3))
rmultinom(n = 1, size = 1, prob = c(0.3,0.4,0.3))
rmultinom(n = 1, size = 1, prob = c(0.3,0.4,0.3))
rmultinom(n = 1, size = 1, prob = c(0.3,0.4,0.3))
rmultinom(n = 1, size = 1, prob = c(0.3,0.4,0.3))
rmultinom(n = 1, size = 1, prob = c(0.05,0.05,0.9))
rmultinom(n = 1, size = 1, prob = c(0.05,0.05,0.9))
rmultinom(n = 1, size = 1, prob = c(0.05,0.05,0.9))
rmultinom(n = 1, size = 1, prob = c(0.05,0.05,0.9))
rmultinom(n = 1, size = 1, prob = c(0.05,0.05,0.9))
rmultinom(n = 1, size = 1, prob = c(0.3,0.4,0.3))
rmultinom(n = 1, size = 1, prob = c(0.3,0.4,0.3))
rmultinom(n = 1, size = 1, prob = c(0.3,0.4,0.3))
rmultinom(n = 1, size = 1, prob = c(0.3,0.4,0.3))
rmultinom(n = 1, size = 1, prob = c(0.3,0.4,0.3))
alloc <- c(1,3,3,4,2,1,1,2,2,2)
alloc
alloc == 3
S
S[,1]
S[,1] == 1
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
traceback()
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
w
sum(Stmp)
Stmp
colSums(S)
w
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
traceback()
probObsInComp
lml
MargLike(x[S[,jj] == 1],mu0[jj],kappa0[jj],nu0[jj],sigma20[jj])
jj
x[S[,jj] == 1]
mu0[jj],kappa0[jj],nu0[jj],sigma20[jj]
mu0[jj];kappa0[jj];nu0[jj];sigma20[jj]
mu0
sigma20
jj
sigma20
sigma20 <- rep(var(x),nComp)
sigma20
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
mu0[jj];kappa0[jj];nu0[jj];sigma20[jj]
lml
probObsInComp
exp(4778)
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
warnings()
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
lml
jj= 1
MargLike(x[S[,jj] == 1],mu0[jj],kappa0[jj],nu0[jj],sigma20[jj])
jj= 2
MargLike(x[S[,jj] == 1],mu0[jj],kappa0[jj],nu0[jj],sigma20[jj])
jj
jj=3
MargLike(x[S[,jj] == 1],mu0[jj],kappa0[jj],nu0[jj],sigma20[jj])
x[S[,jj] == 1]
jj=1
x[S[,jj] == 1]
jj = 1
MargLike(x[S[,jj] == 1],mu0[jj],kappa0[jj],nu0[jj],sigma20[jj])
MargLike(x[S[,2] == 1],mu0[jj],kappa0[jj],nu0[jj],sigma20[jj])
MargLike(x[S[,3] == 1],mu0[jj],kappa0[jj],nu0[jj],sigma20[jj])
S
x[S[,jj] == 1]
x[S[,1] == 1]
x[S[,2] == 1]
MargLike(x[S[,3] == 1],mu0[jj],kappa0[jj],nu0[jj],sigma20[jj])
MargLike(x[S[,2] == 1],mu0[jj],kappa0[jj],nu0[jj],sigma20[jj])
x[S[,3] == 1]
x[S[,3] == 2]
x[S[,2] == 1]
x[S[,1] == 1]
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
lml
MargLike(x[S[,2] == 1],mu0[jj],kappa0[jj],nu0[jj],sigma20[jj])
MargLike(x[S[,1] == 1],mu0[jj],kappa0[jj],nu0[jj],sigma20[jj])
MargLike(x[S[,3] == 1],mu0[jj],kappa0[jj],nu0[jj],sigma20[jj])
w
dmultinom(colSums(Stmp), prob = t(w), log = TRUE)
logPost
rep(0,nComp,1)
nComp
rep(3,3,1)
rep(0,nComp)
rep(0,1,nComp)
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
crossprod(colSums(Stmp),ln(w))
crossprod(colSums(Stmp),log(w))
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
probObsInComp
logPost
crossprod(colSums(Stmp),log(w))
lml
MargLike(x[Stmp[,jj] == 1],mu0[jj],kappa0[jj],nu0[jj],sigma20[jj])
jj=1
MargLike(x[Stmp[,jj] == 1],mu0[jj],kappa0[jj],nu0[jj],sigma20[jj])
jj=2
MargLike(x[Stmp[,jj] == 1],mu0[jj],kappa0[jj],nu0[jj],sigma20[jj])
colSums(Stmp)
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
nComp
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
logLikelihood
mean(logLikelihood[50:])
mean(logLikelihood[50:100])
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
mean(logLikelihood[50:100])
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
var(x)
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
mean(logLikelihood[50:100])
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
mean(logLikelihood[500:1000])
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
mean(logLikelihood[50:100])
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
mean(logLikelihood[500:1000])
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
mean(logLikelihood[500:1000])
MargLike(x,mu0,kappa0,nu0,sigma20)
lml <- MargLike(x,mu0,kappa0,nu0,sigma20)
lml
lml <- MargLike(x,mu0,kappa0,nu0,sigma20)
lml
x
x<-rnorm(100)
lml <- MargLike(x,mu0,kappa0,nu0,sigma20)
lml
nunsigma2n
MargLike <- function(x,mu0,kappa0,nu0,sigma20){
n <- length(x)
xBar <- mean(x)
s2 = sd(x)
kappan <- kappa0 + n
nun <- nu0 + n
nunsigma2n <- nu0*sigma20 + (n-1)*s2 + (kappa0*n/(kappa0 + n))*(xBar-mu0)^2
mun <- (kappa0/kappan)*mu0 + (n/kappan)*xBar
logMargLike <- -n*log(2*pi) -sum(x^2) +log(kappan/kappa0) +(kappan*mun^2-kappa0*mu0^2) +nu0*log(nu0*sigma20) -nun*log(nunsigma2n)
+2*lgamma(nun/2) -2*lgamma(nu0/2) + (nunsigma2n - nu0*sigma20)
logMargLike <- 0.5*logMargLike
keyboard()
}
lml <- MargLike(x,mu0,kappa0,nu0,sigma20)
MargLike <- function(x,mu0,kappa0,nu0,sigma20){
n <- length(x)
xBar <- mean(x)
s2 = sd(x)
kappan <- kappa0 + n
nun <- nu0 + n
nunsigma2n <- nu0*sigma20 + (n-1)*s2 + (kappa0*n/(kappa0 + n))*(xBar-mu0)^2
mun <- (kappa0/kappan)*mu0 + (n/kappan)*xBar
logMargLike <- -n*log(2*pi) -sum(x^2) +log(kappan/kappa0) +(kappan*mun^2-kappa0*mu0^2) +nu0*log(nu0*sigma20) -nun*log(nunsigma2n)
+2*lgamma(nun/2) -2*lgamma(nu0/2) + (nunsigma2n - nu0*sigma20)
logMargLike <- 0.5*logMargLike
browser()
}
lml <- MargLike(x,mu0,kappa0,nu0,sigma20)
logMargLike
-n*log(2*pi) -sum(x^2) +log(kappan/kappa0) +(kappan*mun^2-kappa0*mu0^2) +nu0*log(nu0*sigma20) -nun*log(nunsigma2n)
-n*log(2*pi) -sum(x^2)
kappan
kappa0
MargLike <- function(x,mu0,kappa0,nu0,sigma20){
n <- length(x)
xBar <- mean(x)
s2 = sd(x)
kappan <- kappa0 + n
nun <- nu0 + n
nunsigma2n <- nu0*sigma20 + (n-1)*s2 + (kappa0*n/(kappa0 + n))*(xBar-mu0)^2
mun <- (kappa0/kappan)*mu0 + (n/kappan)*xBar
logMargLike <- -n*log(2*pi) -sum(x^2) +log(kappan/kappa0) +(kappan*mun^2-kappa0*mu0^2) +nu0*log(nu0*sigma20) -nun*log(nunsigma2n)
+2*lgamma(nun/2) -2*lgamma(nu0/2) + (nunsigma2n - nu0*sigma20)
logMargLike <- 0.5*logMargLike
}
lml <- MargLike(x,mu0[1],kappa0[1],nu0[1],sigma20[1])
lml
lml <- MargLikeAlt(x,mu0[1],kappa0[1],nu0[1],sigma20[1])
MargLikeAlt <- function(x,mu0,kappa0,nu0,sigma20){
n <- length(x)
xBar <- mean(x)
s2 = sd(x)
kappan <- kappa0 + n
nun <- nu0 + n
nunsigma2n <- nu0*sigma20 + (n-1)*s2 + (kappa0*n/(kappa0 + n))*(xBar-mu0)^2
mun <- (kappa0/kappan)*mu0 + (n/kappan)*xBar
logMargLike <- (1/2)*log(kappa0) - lgamma(nu0/2) + (nu0/2)*log(nu0*sigma20) + (n/2)*log(pi) + lgamma(nun/2) -(1/2)*log(kappan) -(nun/2)*log(nu0*sigma20 + (y-mun)^2 + kappa0*(mun-mu0)^2)
}
lml <- MargLikeAlt(x,mu0[1],kappa0[1],nu0[1],sigma20[1])
ml
lml
MargLikeAlt <- function(x,mu0,kappa0,nu0,sigma20){
n <- length(x)
xBar <- mean(x)
s2 = sd(x)
kappan <- kappa0 + n
nun <- nu0 + n
nunsigma2n <- nu0*sigma20 + (n-1)*s2 + (kappa0*n/(kappa0 + n))*(xBar-mu0)^2
mun <- (kappa0/kappan)*mu0 + (n/kappan)*xBar
logMargLike <- (1/2)*log(kappa0) - lgamma(nu0/2) + (nu0/2)*log(nu0*sigma20) + (n/2)*log(pi) + lgamma(nun/2) -(1/2)*log(kappan) -(nun/2)*log(nu0*sigma20 + sum((y-mun)^2) + kappa0*(mun-mu0)^2)
}
lml <- MargLikeAlt(x,mu0[1],kappa0[1],nu0[1],sigma20[1])
lml
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
mean(logLikelihood[50:100])
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
MargLikeAlt <- function(x,mu0,kappa0,nu0,sigma20){
n <- length(x)
xBar <- mean(x)
s2 = sd(x)
kappan <- kappa0 + n
nun <- nu0 + n
nunsigma2n <- nu0*sigma20 + (n-1)*s2 + (kappa0*n/(kappa0 + n))*(xBar-mu0)^2
mun <- (kappa0/kappan)*mu0 + (n/kappan)*xBar
logMargLike <- (1/2)*log(kappa0) - lgamma(nu0/2) + (nu0/2)*log(nu0*sigma20) - (n/2)*log(pi) + lgamma(nun/2) -(1/2)*log(kappan) -(nun/2)*log(nu0*sigma20 + sum((x-mun)^2) + kappa0*(mun-mu0)^2)
}
lml <- MargLikeAlt(x,mu0[1],kappa0[1],nu0[1],sigma20[1])
lml
lml <- MargLike(x,mu0[1],kappa0[1],nu0[1],sigma20[1])
lml
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
mean(logLikelihood[50:100])
mean(logLikelihood[50:100])
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
MargLikeAlt <- function(x,mu0,kappa0,nu0,sigma20){
}
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
mean(logLikelihood[50:100])
MargLike <- function(x,mu0,kappa0,nu0,sigma20){
n <- length(x)
xBar <- mean(x)
s2 = sd(x)
kappan <- kappa0 + n
nun <- nu0 + n
nunsigma2n <- nu0*sigma20 + (n-1)*s2 + (kappa0*n/(kappa0 + n))*(xBar-mu0)^2
mun <- (kappa0/kappan)*mu0 + (n/kappan)*xBar
logMargLike <- -n*log(2*pi) -sum(x^2) +log(kappan/kappa0) +(kappan*mun^2-kappa0*mu0^2) +nu0*log(nu0*sigma20) -nun*log(nunsigma2n)
+2*lgamma(nun/2) -2*lgamma(nu0/2) + (nunsigma2n - nu0*sigma20)
logMargLike <- 0.5*logMargLike
}
MargLikeAlt <- function(x,mu0,kappa0,nu0,sigma20){
n <- length(x)
xBar <- mean(x)
s2 = sd(x)
kappan <- kappa0 + n
nun <- nu0 + n
nunsigma2n <- nu0*sigma20 + (n-1)*s2 + (kappa0*n/(kappa0 + n))*(xBar-mu0)^2
mun <- (kappa0/kappan)*mu0 + (n/kappan)*xBar
logMargLike <- (1/2)*log(kappa0) - lgamma(nu0/2) + (nu0/2)*log(nu0*sigma20) - (n/2)*log(pi) + lgamma(nun/2) -(1/2)*log(kappan) -(nun/2)*log(nu0*sigma20 + sum((x-mun)^2) + kappa0*(mun-mu0)^2)
}
MargLike <- function(x,mu0,kappa0,nu0,sigma20){
n <- length(x)
xBar <- mean(x)
s2 = sd(x)
kappan <- kappa0 + n
nun <- nu0 + n
nunsigma2n <- 0.5*(nu0*sigma20 + (n-1)*s2 + (kappa0*n/(kappa0 + n))*(xBar-mu0)^2)
mun <- (kappa0/kappan)*mu0 + (n/kappan)*xBar
logMargLike <- lgamma(nun/2) - lgamma(nu0/2) + (nu0/2)*log((nu0*sigma20)/2) -(nun/2)*log(0.5*(nu0*sigma20) + 0.5*(n-1)*s2 + 0.5*((kappa0*n)/(kappan))*(xBar-mu0)^2) +  (1/2)*log(kappa0/kappan) - (n/2)*log(2*pi)
}
MargLike
mean(logLikelihood[50:100])
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
mean(logLikelihood[50:100])
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
mean(logLikelihood[50:100])
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
mean(logLikelihood[50:100])
logLikelihood[100]
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/SharedProjects/Mans/TopicModels/ParallelPartiallyCollapsed/Code/NormalMixtureGibbsCollapsed.R')
source('~/Dropbox/Teaching/BayesLearning/Code/SimulateDiscreteMarkovChain.R')
source('~/Dropbox/Teaching/BayesianLearningLiU/BayesLearnCourse/Code/NormalNonInfoPrior.R', echo=TRUE)
source('~/Dropbox/Teaching/BayesianLearningLiU/BayesLearnCourse/Code/NormalNonInfoPrior.R', echo=TRUE)
source('~/Dropbox/Teaching/BayesianLearningLiU/BayesLearnCourse/Code/NormalNonInfoPrior.R', echo=TRUE)
source('~/Dropbox/Teaching/BayesianLearningLiU/BayesLearnCourse/Code/NormalNonInfoPrior.R', echo=TRUE)
source('~/Dropbox/Teaching/BayesianLearningLiU/BayesLearnCourse/Code/NormalNonInfoPrior.R', echo=TRUE)
source('~/Dropbox/Teaching/BayesianLearningLiU/BayesLearnCourse/Code/NormalNonInfoPrior.R', echo=TRUE)
Datamean<-mean(Data)
s2<-var(Data)
n<-length(Data)
PostDraws=matrix(0,NDraws,2)
debugSource('~/Dropbox/Teaching/BayesianLearningLiU/BayesLearnCourse/Code/NormalNonInfoPrior.R', echo=TRUE)
PostDraws
PostDraws[,1]
source('~/.active-rstudio-document', echo=TRUE)
source('~/Dropbox/Teaching/BayesianLearningLiU/BayesLearnCourse/Code/NormalNonInfoPrior.R', echo=TRUE)
source('~/Dropbox/Teaching/BayesianLearningLiU/BayesLearnCourse/Code/NormalNonInfoPrior.R', echo=TRUE)
source('~/Dropbox/Teaching/BayesianLearningLiU/BayesLearnCourse/Code/NormalNonInfoPrior.R', echo=TRUE)
source('~/Dropbox/Teaching/BayesianLearningLiU/BayesLearnCourse/Code/NormalNonInfoPrior.R', echo=TRUE)
